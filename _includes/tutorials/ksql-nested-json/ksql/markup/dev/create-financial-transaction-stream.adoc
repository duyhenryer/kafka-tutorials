The first thing we do is to create a stream `financial_report` based off stock purchase transactions


[source, sql]
----
CREATE STREAM financial_report (
	      id VARCHAR,
              transaction STRUCT<num_shares INT,     <1>
             	                  amount DOUBLE,
             	                  txn_ts VARCHAR,
             	                  customer STRUCT<first_name VARCHAR,  <2>
             	                                  last_name VARCHAR,
             	                                  id INT,
             	                                  email VARCHAR>,
                                   company STRUCT<name VARCHAR,        <3>
                                                  ticker VARCHAR,
                                                  id VARCHAR,
                                                  address VARCHAR>>)
 WITH (KAFKA_TOPIC='fin_txns',
       VALUE_FORMAT='JSON',
       TIMESTAMP='txn_ts',
       TIMESTAMP_FORMAT='yyyy-MM-dd''T''HH:mm:ssX',
       PARTITIONS=1);

----

<1> The entire stock transaction is nested so we create a STRUCT
<2> The nested customer fields
<3> The nested company fields

A table is more fitting for this suspicious names data because it is a mutable collection that changes over time. We may want to add company names to this table or remove them in the future.
